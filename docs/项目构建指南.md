# CHTLé¡¹ç›®æ„å»ºæŒ‡å—

## ğŸ“‹ æ¦‚è¿°

CHTLï¼ˆC++ HyperText Languageï¼‰æ˜¯åŸºäºC++å®ç°çš„è¶…æ–‡æœ¬è¯­è¨€ç¼–è¯‘å™¨ï¼Œæä¾›äº†å®Œæ•´çš„å¼€å‘å·¥å…·é“¾ï¼ŒåŒ…æ‹¬ç¼–è¯‘å™¨ã€VSCodeæ‰©å±•å’Œæ¨¡å—ç³»ç»Ÿã€‚æœ¬æŒ‡å—è¯¦ç»†è¯´æ˜å¦‚ä½•æ„å»ºå’Œä½¿ç”¨CHTLé¡¹ç›®ã€‚

## ğŸ”§ ç³»ç»Ÿè¦æ±‚

### Windows
- Visual Studio 2022 (æˆ–æ›´é«˜ç‰ˆæœ¬)
- CMake 3.16+
- Node.js 16.0+
- npm 8.0+
- PowerShell 5.0+

### Linux
- GCC 9.0+ æˆ– Clang 10.0+
- CMake 3.16+
- Make
- Node.js 16.0+
- npm 8.0+
- zip/unzip

### macOS
- Xcode Command Line Tools
- CMake 3.16+
- Node.js 16.0+
- npm 8.0+
- zip/unzip

## ğŸ“ é¡¹ç›®ç»“æ„

```
CHTL/
â”œâ”€â”€ src/                    # ç¼–è¯‘å™¨æºä»£ç 
â”‚   â”œâ”€â”€ CHTL/              # CHTLæ ¸å¿ƒè§£æå™¨
â”‚   â”œâ”€â”€ CHTLJS/            # CHTL JSæ‰©å±•
â”‚   â”œâ”€â”€ Scanner/           # ç»Ÿä¸€æ‰«æå™¨
â”‚   â”œâ”€â”€ Dispatcher/        # ç¼–è¯‘å™¨è°ƒåº¦å™¨
â”‚   â””â”€â”€ main.cpp           # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ include/               # å¤´æ–‡ä»¶
â”œâ”€â”€ tests/                 # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ examples/              # ç¤ºä¾‹æ–‡ä»¶
â”œâ”€â”€ scripts/               # æ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ windows/           # Windowsè„šæœ¬
â”‚   â”œâ”€â”€ linux/             # Linuxè„šæœ¬
â”‚   â””â”€â”€ macos/             # macOSè„šæœ¬
â”œâ”€â”€ vscode-chtl-extension/ # VSCodeæ‰©å±•
â”œâ”€â”€ Chtholly/              # ç‚æœµè‰æ¨¡å—
â”‚   â”œâ”€â”€ CMOD/              # CMODç»„ä»¶
â”‚   â””â”€â”€ CJMOD/             # CJMODç»„ä»¶
â”œâ”€â”€ Yuigahama/             # ç”±æ¯”æ»¨ç»“è¡£æ¨¡å—
â”‚   â””â”€â”€ CMOD/              # çº¯CMODç»„ä»¶
â””â”€â”€ docs/                  # é¡¹ç›®æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ç»Ÿä¸€æ„å»ºè„šæœ¬ï¼ˆæ¨èï¼‰

è¿™æ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼Œä¼šè‡ªåŠ¨å®Œæˆæ‰€æœ‰æ„å»ºæ­¥éª¤ï¼š

**Windows:**
```cmd
cd scripts\windows
build_unified.bat
```

**Linux/macOS:**
```bash
cd scripts/linux    # æˆ– scripts/macos
./build_unified.sh
```

ç»Ÿä¸€æ„å»ºè„šæœ¬ä¼šæ‰§è¡Œï¼š
1. æ„å»ºCHTLç¼–è¯‘å™¨ï¼ˆReleaseç‰ˆæœ¬ï¼‰
2. è‡ªåŠ¨æ‰“åŒ…æ‰€æœ‰æ¨¡å—ï¼ˆChthollyå’ŒYuigahamaï¼‰
3. æ„å»ºVSCodeæ‰©å±•å¹¶åµŒå…¥ç¼–è¯‘å™¨å’Œæ¨¡å—

### æ–¹æ³•äºŒï¼šåˆ†æ­¥æ„å»º

å¦‚æœéœ€è¦æ›´ç²¾ç¡®çš„æ§åˆ¶ï¼Œå¯ä»¥åˆ†æ­¥æ‰§è¡Œï¼š

#### 1. æ„å»ºç¼–è¯‘å™¨

**Releaseç‰ˆæœ¬:**
```bash
# Windows
scripts\windows\build_compiler_release.bat

# Linux/macOS
scripts/linux/build_compiler_release.sh
scripts/macos/build_compiler_release.sh
```

**Debugç‰ˆæœ¬:**
```bash
# Windows
scripts\windows\build_compiler_debug.bat

# Linux/macOS
scripts/linux/build_compiler_debug.sh
scripts/macos/build_compiler_debug.sh
```

#### 2. æ‰“åŒ…æ¨¡å—

**æ‰“åŒ…å•ä¸ªCMODæ¨¡å—:**
```bash
# Windows
scripts\windows\package_cmod.bat Chtholly\CMOD\Core

# Linux/macOS
scripts/linux/package_cmod.sh Chtholly/CMOD/Core
```

**æ‰“åŒ…å•ä¸ªCJMODæ¨¡å—:**
```bash
# Windows
scripts\windows\package_cjmod.bat Chtholly\CJMOD\printMylove

# Linux/macOS
scripts/linux/package_cjmod.sh Chtholly/CJMOD/printMylove
```

**æ™ºèƒ½æ‰“åŒ…ï¼ˆè‡ªåŠ¨è¯†åˆ«ç±»å‹ï¼‰:**
```bash
# Windows
scripts\windows\package_unified.bat Chtholly\CMOD\Core

# Linux/macOS
scripts/linux/package_unified.sh Chtholly/CMOD/Core
```

#### 3. æ„å»ºVSCodeæ‰©å±•

```bash
# Windows
scripts\windows\build_vscode_plugin.bat

# Linux/macOS
scripts/linux/build_vscode_plugin.sh
scripts/macos/build_vscode_plugin.sh
```

## ğŸ“¦ æ„å»ºè¾“å‡º

æˆåŠŸæ„å»ºåï¼Œæ‚¨å°†è·å¾—ä»¥ä¸‹æ–‡ä»¶ï¼š

### ç¼–è¯‘å™¨
- **Windows:** `bin/chtl-compiler.exe`
- **Linux/macOS:** `bin/chtl-compiler`

### æ¨¡å—åŒ…
- **CMODåŒ…:** `dist/modules/*.cmod`
- **CJMODåŒ…:** `dist/modules/*.cjmod`

### VSCodeæ‰©å±•
- **æ‰©å±•åŒ…:** `dist/chtl-*.vsix`

## ğŸ§ª æµ‹è¯•æ„å»º

### åŸºæœ¬åŠŸèƒ½æµ‹è¯•

```bash
# æµ‹è¯•ç¼–è¯‘å™¨
./bin/chtl-compiler --help

# ç¼–è¯‘ç¤ºä¾‹æ–‡ä»¶
./bin/chtl-compiler examples/test.chtl -o output.html

# æ‰«ææµ‹è¯•
./bin/chtl-compiler --scan-only examples/complex_test.chtl
```

### æ¨¡å—æµ‹è¯•

```bash
# éªŒè¯CMODåŒ…
cd examples
../bin/chtl-compiler chtholly_test_example.chtl

# éªŒè¯CJMODåŒ…  
../bin/chtl-compiler test_chtljs.chtl
```

## ğŸ› å¸¸è§é—®é¢˜

### Windowsæ„å»ºé—®é¢˜

**Q: CMakeé…ç½®å¤±è´¥**
```
A: ç¡®ä¿å®‰è£…äº†Visual Studio 2022å¹¶åŒ…å«C++å·¥å…·é“¾
   æ£€æŸ¥CMakeç‰ˆæœ¬ï¼šcmake --version
```

**Q: ç¼–è¯‘å™¨é“¾æ¥é”™è¯¯**
```
A: æ£€æŸ¥ANTLR4ä¾èµ–ï¼š
   - antlr-4.13.2-complete.jar åº”åœ¨é¡¹ç›®æ ¹ç›®å½•
   - ç¡®ä¿ç¯å¢ƒå˜é‡JAVA_HOMEè®¾ç½®æ­£ç¡®
```

### Linuxæ„å»ºé—®é¢˜

**Q: GCCç‰ˆæœ¬è¿‡ä½**
```
A: å‡çº§GCCåˆ°9.0+:
   sudo apt update
   sudo apt install gcc-9 g++-9
```

**Q: ä¾èµ–ç¼ºå¤±**
```
A: å®‰è£…æ„å»ºä¾èµ–:
   sudo apt install build-essential cmake uuid-dev
```

### macOSæ„å»ºé—®é¢˜

**Q: Xcode Command Line Toolsç¼ºå¤±**
```
A: å®‰è£…å¼€å‘å·¥å…·:
   xcode-select --install
```

**Q: æƒé™é—®é¢˜**
```
A: ç¡®ä¿è„šæœ¬æœ‰æ‰§è¡Œæƒé™:
   chmod +x scripts/macos/*.sh
```

### VSCodeæ‰©å±•é—®é¢˜

**Q: npm installå¤±è´¥**
```
A: æ¸…ç†ç¼“å­˜é‡è¯•:
   cd vscode-chtl-extension
   npm cache clean --force
   npm install
```

**Q: vsceå‘½ä»¤ä¸å­˜åœ¨**
```
A: å®‰è£…vsce:
   npm install -g vsce
```

## ğŸ” é«˜çº§æ„å»ºé€‰é¡¹

### CMakeæ„å»ºé€‰é¡¹

```bash
# å¯ç”¨è°ƒè¯•ä¿¡æ¯
cmake -DCMAKE_BUILD_TYPE=Debug

# æŒ‡å®šç¼–è¯‘å™¨
cmake -DCMAKE_CXX_COMPILER=g++-9

# è‡ªå®šä¹‰å®‰è£…è·¯å¾„
cmake -DCMAKE_INSTALL_PREFIX=/usr/local
```

### å¹¶è¡Œæ„å»º

```bash
# Windows (ä½¿ç”¨æ‰€æœ‰CPUæ ¸å¿ƒ)
cmake --build . --config Release --parallel

# Linux/macOS
make -j$(nproc)        # Linux
make -j$(sysctl -n hw.ncpu)  # macOS
```

### äº¤å‰ç¼–è¯‘

å¯¹äºéœ€è¦åœ¨ä¸åŒå¹³å°é—´åˆ†å‘çš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨Dockeræˆ–è™šæ‹Ÿæœºè¿›è¡Œäº¤å‰ç¼–è¯‘ã€‚

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### Releaseæ„å»ºä¼˜åŒ–

Releaseç‰ˆæœ¬å·²å¯ç”¨ä»¥ä¸‹ä¼˜åŒ–ï¼š
- O3çº§åˆ«ä¼˜åŒ–
- é“¾æ¥æ—¶ä¼˜åŒ–ï¼ˆLTOï¼‰
- è°ƒè¯•ä¿¡æ¯å‰¥ç¦»
- é™æ€é“¾æ¥ï¼ˆå‡å°‘ä¾èµ–ï¼‰

### æ„å»ºæ—¶é—´ä¼˜åŒ–

```bash
# ä½¿ç”¨ccacheåŠ é€Ÿç¼–è¯‘ï¼ˆLinux/macOSï¼‰
sudo apt install ccache  # Linux
brew install ccache       # macOS

export CXX="ccache g++"
```

## ğŸ”„ æŒç»­é›†æˆ

é¡¹ç›®æ”¯æŒCI/CDæµæ°´çº¿ï¼Œå¯ä»¥å‚è€ƒ `.github/workflows/` ä¸­çš„é…ç½®æ–‡ä»¶è®¾ç½®è‡ªåŠ¨æ„å»ºã€‚

### GitHub Actionsç¤ºä¾‹

```yaml
name: Build CHTL
on: [push, pull_request]
jobs:
  build:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
    steps:
    - uses: actions/checkout@v3
    - name: Build
      run: scripts/${{ runner.os }}/build_unified.sh
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [CHTLè¯­æ³•æ–‡æ¡£](./CHTLè¯­æ³•æ–‡æ¡£.md) - å®Œæ•´è¯­æ³•è¯´æ˜
- [CMODå¼€å‘æŒ‡å—](./CMODæ¨¡å—å¼€å‘æŒ‡å—.md) - æ¨¡å—å¼€å‘æ•™ç¨‹
- [CJMODå¼€å‘æŒ‡å—](./CJMODæ¨¡å—å¼€å‘æŒ‡å—.md) - C++æ‰©å±•å¼€å‘
- [ç‚æœµè‰æ¨¡å—ä½¿ç”¨æ–‡æ¡£](./ç‚æœµè‰æ¨¡å—ä½¿ç”¨æ–‡æ¡£.md) - ç‚æœµè‰æ¨¡å—è¯´æ˜
- [ç”±æ¯”æ»¨ç»“è¡£æ¨¡å—ä½¿ç”¨æ–‡æ¡£](./ç”±æ¯”æ»¨ç»“è¡£æ¨¡å—ä½¿ç”¨æ–‡æ¡£.md) - ç”±æ¯”æ»¨ç»“è¡£æ¨¡å—è¯´æ˜

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼æ„å»ºç›¸å…³é—®é¢˜è¯·æä¾›ï¼š
1. æ“ä½œç³»ç»Ÿå’Œç‰ˆæœ¬
2. ç¼–è¯‘å™¨ç‰ˆæœ¬
3. å®Œæ•´çš„é”™è¯¯æ—¥å¿—
4. å¤ç°æ­¥éª¤

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ï¼Œè¯¦è§ [LICENSE](../LICENSE) æ–‡ä»¶ã€‚