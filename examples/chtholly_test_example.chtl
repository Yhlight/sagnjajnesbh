// ç‚æœµè‰æ¨¡å—ä½¿ç”¨ç¤ºä¾‹ - æ ¹æ®CHTLè¯­æ³•æ–‡æ¡£ä¸¥æ ¼å®ç°
// å±•ç¤ºæ··åˆæ¨¡å—ï¼ˆCMOD + CJMODï¼‰çš„å®Œæ•´ä½¿ç”¨æ–¹å¼

[Import] @Chtl from Chtholly.Core
[Import] @Chtl from Chtholly.Accordion
[Import] @CJmod from Chtholly.ChthollyJS

[Namespace] ChthollyDemo {

    // æ¼”ç¤º[Origin]å¯ä»¥åœ¨ä»»æ„ä½ç½®ä½¿ç”¨
    [Origin] @Html DemoHeader {
        <header class="demo-header">
            <h1>ç‚æœµè‰æ¨¡å—æ¼”ç¤º</h1>
            <p>ä¸–ç•Œä¸Šæœ€å¹¸ç¦çš„å¥³å­©</p>
        </header>
    }

    // ä½¿ç”¨ç‚æœµè‰æ ¸å¿ƒå˜é‡
    [Template] @Style DemoPageStyle {
        body {
            font-family: ChthollyFonts();
            background: linear-gradient(135deg, Colors(), ChthollyColors());
            margin: 0;
            padding: ChthollySpacing();
            transition: ChthollyAnimations();
        }
        
        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: ChthollySpacing();
            background: rgba(255, 255, 255, 0.9);
            border-radius: var(--chtholly-radius-xl);
            box-shadow: var(--chtholly-shadow-magical);
        }
        
        .demo-section {
            margin-bottom: ChthollySpacing();
            padding: ChthollySpacing();
            border: 1px solid var(--chtholly-border-light);
            border-radius: var(--chtholly-radius-lg);
        }
        
        .demo-title {
            color: var(--chtholly-primary);
            font-size: var(--chtholly-font-2xl);
            font-weight: var(--chtholly-font-bold);
            margin-bottom: ChthollySpacing();
        }
    }

    [Template] @Element DemoPage {
        html {
            lang: "zh-CN";
            
            head {
                meta { charset: "UTF-8"; }
                meta { 
                    name: "viewport"; 
                    content: "width=device-width, initial-scale=1.0"; 
                }
                title { text: "ç‚æœµè‰æ¨¡å—æ¼”ç¤º"; }
            }
            
            body {
                // æ’å…¥åŸå§‹åµŒå…¥çš„å¤´éƒ¨
                [Origin] @Html {
                    [Import] DemoHeader
                }
                
                div {
                    class: "demo-container";
                    
                    // æ¼”ç¤º1ï¼šæ‰‹é£ç´ç»„ä»¶
                    div {
                        class: "demo-section";
                        
                        h2 { 
                            class: "demo-title";
                            text: "æ‰‹é£ç´ç»„ä»¶æ¼”ç¤º"; 
                        }
                        
                        // ä½¿ç”¨ç‚æœµè‰æ‰‹é£ç´
                        ChthollyAccordionPanel {
                            ChthollyAccordion {
                                title: "ç‚æœµè‰çš„æ•…äº‹";
                                content: "åœ¨æµ®æ¸¸å¤§é™†ç¾¤çš„å¤©ç©ºä¸Šï¼Œä½ç€è¢«ç§°ä¸º"å¦–ç²¾"çš„ç§æ—...";
                            }
                            
                            ChthollyAccordion {
                                title: "æœ€åçš„æˆ˜å£«";
                                content: "ä½œä¸ºæœ€åä¸€ä½èƒ½å¤Ÿä½¿ç”¨åœ£å‰‘çš„æˆ˜å£«ï¼Œç‚æœµè‰è‚©è´Ÿç€ä¿æŠ¤å¤§å®¶çš„ä½¿å‘½...";
                            }
                            
                            ChthollyAccordion {
                                title: "çŸ­æš‚è€Œç¾å¥½çš„æ—¥å­";
                                content: "ä¸å¨å»‰ç›¸é‡åï¼Œç‚æœµè‰ç¬¬ä¸€æ¬¡ä½“éªŒåˆ°äº†æ™®é€šå¥³å­©çš„ç”Ÿæ´»...";
                            }
                        }
                    }
                    
                    // æ¼”ç¤º2ï¼šCHTL JSåŠŸèƒ½
                    div {
                        class: "demo-section";
                        
                        h2 { 
                            class: "demo-title";
                            text: "CHTL JSåŠŸèƒ½æ¼”ç¤º"; 
                        }
                        
                        div {
                            class: "cjmod-demo";
                            
                            script {
                                -- è¿™æ˜¯ä¸€ä¸ªä¸Šä¸‹æ–‡æ³¨é‡Šï¼Œä¼šç”ŸæˆJavaScriptæ³¨é‡Š
                                -- æ¼”ç¤ºprintMyloveåŠŸèƒ½
                                
                                // ä½¿ç”¨æ–°çš„CJMOD API
                                const myLoveImage = printMylove({
                                    url: "chtholly_portrait.jpg",
                                    mode: "ASCII",
                                    width: 80,
                                    height: 24,
                                    scale: 1.0
                                });
                                
                                console.log("ç‚æœµè‰çš„ASCIIè‰ºæœ¯ï¼š");
                                console.log(myLoveImage);
                                
                                -- æ¼”ç¤ºiNeverAwayåŠŸèƒ½ï¼ˆæ”¯æŒè‡ªå®šä¹‰é”®ï¼‰
                                vir ChthollyMagic = iNeverAway({
                                    Void<Blessing>: function(target) {
                                        console.log("ç‚æœµè‰ç»™äºˆäº†" + target + "ç¥ç¦");
                                        return "ç¥ç¦ä¹‹å…‰é—ªè€€ç€...";
                                    },
                                    
                                    Void<Protection>: function(target) {
                                        console.log("ç‚æœµè‰ä¿æŠ¤ç€" + target);
                                        return "æ¸©æš–çš„ä¿æŠ¤ä¹‹å…‰åŒ…å›´ç€" + target;
                                    },
                                    
                                    String<Memory>: function() {
                                        return "ç‚æœµè‰çè´µçš„è®°å¿†ç‰‡æ®µ...";
                                    },
                                    
                                    Promise<Wish>: function(wish) {
                                        return new Promise(resolve => {
                                            setTimeout(() => {
                                                resolve("ç‚æœµè‰çš„æ„¿æœ›: " + wish + " å°†ä¼šå®ç°");
                                            }, 1000);
                                        });
                                    }
                                });
                                
                                // ä½¿ç”¨virå¯¹è±¡
                                ChthollyMagic->Blessing("å¨å»‰");
                                ChthollyMagic->Protection("å­©å­ä»¬");
                                
                                const memory = ChthollyMagic->Memory();
                                console.log(memory);
                                
                                ChthollyMagic->Wish("å’Œå¤§å®¶ä¸€èµ·è¿‡å¹³å‡¡çš„ç”Ÿæ´»").then(result => {
                                    console.log(result);
                                });
                            }
                        }
                    }
                    
                    // æ¼”ç¤º3ï¼šæ··åˆåŸå§‹åµŒå…¥
                    div {
                        class: "demo-section";
                        
                        h2 { 
                            class: "demo-title";
                            text: "åŸå§‹åµŒå…¥æ¼”ç¤º"; 
                        }
                        
                        // åœ¨å…ƒç´ ä¸­ä½¿ç”¨[Origin] - è¯æ˜å¯ä»¥åœ¨ä»»æ„ä½ç½®ä½¿ç”¨
                        [Origin] @Style MixedStyles {
                            /* è¿™æ˜¯CSSä¸Šä¸‹æ–‡ä¸­çš„æ³¨é‡Š */
                            .mixed-demo {
                                background: linear-gradient(45deg, #fd79a8, #fdcb6e);
                                padding: 20px;
                                border-radius: 15px;
                                color: white;
                                text-align: center;
                                box-shadow: 0 8px 32px rgba(253, 121, 168, 0.3);
                            }
                            
                            .sakura-animation {
                                animation: sakuraFall 3s ease-in-out infinite;
                            }
                            
                            @keyframes sakuraFall {
                                0% { transform: translateY(-20px) rotate(0deg); opacity: 0; }
                                50% { transform: translateY(10px) rotate(180deg); opacity: 1; }
                                100% { transform: translateY(40px) rotate(360deg); opacity: 0; }
                            }
                        }
                        
                        div {
                            class: "mixed-demo";
                            
                            [Origin] @Html MixedContent {
                                <div class="sakura-animation">ğŸŒ¸</div>
                                <p>è¿™æ˜¯ç‚æœµè‰çš„æ¨±èŠ±ç‰¹æ•ˆ</p>
                                <div class="sakura-animation" style="animation-delay: 1s;">ğŸŒ¸</div>
                            }
                        }
                        
                        // åœ¨å—çš„æœ«å°¾ä¹Ÿå¯ä»¥ä½¿ç”¨[Origin]
                        [Origin] @JavaScript AnimationControl {
                            // åŠ¨ç”»æ§åˆ¶è„šæœ¬
                            function startSakuraEffect() {
                                const sakuras = document.querySelectorAll('.sakura-animation');
                                sakuras.forEach((sakura, index) => {
                                    sakura.style.animationDelay = (index * 0.5) + 's';
                                });
                            }
                            
                            document.addEventListener('DOMContentLoaded', startSakuraEffect);
                        }
                    }
                }
                
                // é¡µè„šä¹Ÿä½¿ç”¨åŸå§‹åµŒå…¥
                [Origin] @Html DemoFooter {
                    <footer style="text-align: center; padding: 20px; color: #666;">
                        <p>ç‚æœµè‰æ¨¡å— - CHTLè¯­æ³•æ–‡æ¡£ä¸¥æ ¼å®ç°</p>
                        <p>"æˆ‘æƒ³è¦æˆä¸ºå¤§äººï¼Œæƒ³è¦çŸ¥é“ä»€ä¹ˆæ˜¯æ‹çˆ±ã€‚"</p>
                    </footer>
                }
            }
        }
    }
    
    // åœ¨å‘½åç©ºé—´æœ«å°¾ä½¿ç”¨[Origin] - å†æ¬¡è¯æ˜ä½ç½®æ— é™åˆ¶
    [Origin] @JavaScript GlobalUtilities {
        // å…¨å±€å·¥å…·å‡½æ•°
        window.ChthollyUtils = {
            showMessage: function(message) {
                const toast = document.createElement('div');
                toast.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: linear-gradient(45deg, #fd79a8, #fdcb6e);
                    color: white;
                    padding: 15px;
                    border-radius: 10px;
                    box-shadow: 0 8px 32px rgba(253, 121, 168, 0.3);
                    z-index: 9999;
                    animation: slideIn 0.3s ease-out;
                `;
                toast.textContent = message;
                document.body.appendChild(toast);
                
                setTimeout(() => {
                    toast.style.animation = 'slideOut 0.3s ease-in';
                    setTimeout(() => toast.remove(), 300);
                }, 3000);
            },
            
            // ä½¿ç”¨é‡æ–°è®¾è®¡çš„CJMOD API
            testCJMODIntegration: function() {
                // è¿™é‡Œä¼šè°ƒç”¨ChthollyJS CJMODæ¨¡å—
                console.log("æµ‹è¯•CJMODé›†æˆ...");
                
                // æµ‹è¯•åŒæŒ‡é’ˆæ»‘åŠ¨çª—å£æ‰«æ
                if (window.setScanStrategy) {
                    window.setScanStrategy(1); // SLIDING_WINDOW
                    console.log("æ‰«æç­–ç•¥å·²è®¾ç½®ä¸ºæ»‘åŠ¨çª—å£");
                }
                
                // æµ‹è¯•virå‡½æ•°ç»‘å®š
                if (window.virFunctionBind) {
                    window.virFunctionBind("printMylove");
                    window.virFunctionBind("iNeverAway");
                    console.log("virå‡½æ•°ç»‘å®šå®Œæˆ");
                }
            }
        };
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            ChthollyUtils.showMessage("ç‚æœµè‰æ¨¡å—æ¼”ç¤ºåŠ è½½å®Œæˆï¼");
            ChthollyUtils.testCJMODIntegration();
            
            console.log("=== ç‚æœµè‰æ¨¡å—æ¼”ç¤º ===");
            console.log("âœ“ CMODç»„ä»¶å·²åŠ è½½");
            console.log("âœ“ CJMODæ‰©å±•å·²åŠ è½½");
            console.log("âœ“ æ–°çš„ç»Ÿä¸€APIå·²å¯ç”¨");
            console.log("âœ“ [Origin]åŸå§‹åµŒå…¥å¯åœ¨ä»»æ„ä½ç½®ä½¿ç”¨");
            console.log("âœ“ \"--\"æ³¨é‡Šä¸Šä¸‹æ–‡æ„ŸçŸ¥å·²å¯ç”¨");
        });
    }
}

// åœ¨æ–‡ä»¶æœ«å°¾ä½¿ç”¨[Origin] - æœ€ç»ˆè¯æ˜çœŸçš„å¯ä»¥åœ¨ä»»æ„ä½ç½®ä½¿ç”¨
[Origin] @Style DocumentEndStyles {
    /* æ–‡æ¡£æœ«å°¾çš„æ ·å¼å®šä¹‰ */
    @media (prefers-color-scheme: dark) {
        body {
            background: linear-gradient(135deg, #2d3436, #636e72);
            color: #ddd;
        }
        
        .demo-container {
            background: rgba(45, 52, 54, 0.9);
            border: 1px solid #636e72;
        }
    }
    
    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 768px) {
        .demo-container {
            margin: 10px;
            padding: 15px;
        }
        
        .demo-title {
            font-size: var(--chtholly-font-xl);
        }
    }
}