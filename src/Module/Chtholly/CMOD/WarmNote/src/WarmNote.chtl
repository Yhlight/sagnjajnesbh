// æŒ‰CHTLè¯­æ³•æ–‡æ¡£ï¼šä½¿ç”¨[Custom] @Elementå®šä¹‰ç»„ä»¶ï¼Œä½¿ç”¨å±€éƒ¨styleå’Œscript
// ç‚æœµè‰æš–è‰²ç¬”è®° - è®°å½•æœ€çè´µçš„å›å¿†æ—¶å…‰
[Custom] @Element ChthollyWarmNote
{
    div
    {
        class: "chtholly-warm-note";
        
        style
        {
            .chtholly-warm-note
            {
                max-width: 500px;
                margin: 20px auto;
                background: linear-gradient(135deg, #fff8dc 0%, #ffefd5 50%, #ffe4e1 100%);
                border-radius: 20px;
                padding: 25px;
                box-shadow: 
                    0 10px 30px rgba(255, 218, 185, 0.3),
                    inset 0 1px 0 rgba(255, 255, 255, 0.8);
                border: 3px solid #ffd4a3;
                font-family: "Georgia", "Times New Roman", serif;
                position: relative;
                overflow: hidden;
            }
            
            .chtholly-warm-note::before
            {
                content: '';
                position: absolute;
                top: -50%;
                left: -50%;
                width: 200%;
                height: 200%;
                background: radial-gradient(circle, rgba(255, 218, 185, 0.1) 0%, transparent 70%);
                animation: warmGlow 4s ease-in-out infinite alternate;
            }
            
            @keyframes warmGlow
            {
                0% { transform: rotate(0deg) scale(1); opacity: 0.3; }
                100% { transform: rotate(180deg) scale(1.1); opacity: 0.1; }
            }
            
            .note-header
            {
                text-align: center;
                margin-bottom: 25px;
                position: relative;
                z-index: 2;
            }
            
            .note-title
            {
                font-size: 24px;
                font-weight: 300;
                color: #d2691e;
                text-shadow: 0 2px 4px rgba(210, 105, 30, 0.1);
                margin-bottom: 8px;
                font-family: "Brush Script MT", cursive;
            }
            
            .note-subtitle
            {
                font-size: 14px;
                color: #cd853f;
                opacity: 0.8;
                font-style: italic;
            }
            
            .note-editor
            {
                position: relative;
                z-index: 2;
                margin-bottom: 20px;
            }
            
            .note-textarea
            {
                width: 100%;
                min-height: 200px;
                padding: 20px;
                border: 2px solid #f4a460;
                border-radius: 15px;
                background: linear-gradient(to bottom, rgba(255, 255, 255, 0.9), rgba(255, 248, 220, 0.9));
                color: #8b4513;
                font-size: 16px;
                line-height: 1.8;
                font-family: "Georgia", serif;
                resize: vertical;
                transition: all 0.3s ease;
                box-shadow: inset 0 2px 8px rgba(244, 164, 96, 0.1);
            }
            
            &:focus .note-textarea
            {
                border-color: #daa520;
                outline: none;
                box-shadow: 
                    inset 0 2px 8px rgba(244, 164, 96, 0.2),
                    0 0 0 4px rgba(218, 165, 32, 0.1);
                background: linear-gradient(to bottom, rgba(255, 255, 255, 1), rgba(255, 248, 220, 1));
            }
            
            .note-toolbar
            {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 15px;
                position: relative;
                z-index: 2;
            }
            
            .toolbar-group
            {
                display: flex;
                gap: 8px;
            }
            
            .toolbar-btn
            {
                padding: 8px 12px;
                border: none;
                border-radius: 20px;
                background: linear-gradient(45deg, #ffd4a3, #ffcc99);
                color: #8b4513;
                font-size: 12px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
                box-shadow: 0 2px 8px rgba(255, 212, 163, 0.3);
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            &:hover .toolbar-btn
            {
                background: linear-gradient(45deg, #ffcc99, #ffb366);
                transform: translateY(-2px);
                box-shadow: 0 4px 15px rgba(255, 212, 163, 0.5);
            }
            
            .note-stats
            {
                display: flex;
                gap: 15px;
                font-size: 12px;
                color: #cd853f;
                opacity: 0.7;
            }
            
            .stat-item
            {
                display: flex;
                align-items: center;
                gap: 4px;
            }
            
            .note-footer
            {
                text-align: center;
                padding-top: 20px;
                border-top: 1px solid rgba(244, 164, 96, 0.3);
                position: relative;
                z-index: 2;
            }
            
            .save-status
            {
                font-size: 12px;
                color: #daa520;
                font-style: italic;
            }
            
            .last-saved
            {
                font-size: 11px;
                color: #cd853f;
                opacity: 0.6;
                margin-top: 5px;
            }
        }
        
        script
        {
            // æŒ‰CHTLè¯­æ³•æ–‡æ¡£ï¼šä½¿ç”¨è™šå¯¹è±¡å’Œå¢å¼ºé€‰æ‹©å™¨ç®¡ç†æš–è‰²ç¬”è®°
            vir warmNoteController = iNeverAway({
                Save: function() {
                    const content = {{.note-textarea}}.value;
                    const timestamp = new Date().toLocaleString('zh-CN');
                    
                    // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                    localStorage.setItem('chtholly_warm_note', content);
                    localStorage.setItem('chtholly_warm_note_time', timestamp);
                    
                    {{.save-status}}.textContent = 'å·²ä¿å­˜';
                    {{.last-saved}}.textContent = 'æœ€åä¿å­˜: ' + timestamp;
                    
                    console.log('ğŸŒ¸ ç‚æœµè‰çš„æš–è‰²ç¬”è®°å·²ä¿å­˜');
                    
                    // æ˜¾ç¤ºä¿å­˜åŠ¨ç”»
                    this.showSaveAnimation();
                },
                
                Load: function() {
                    const saved = localStorage.getItem('chtholly_warm_note');
                    const savedTime = localStorage.getItem('chtholly_warm_note_time');
                    
                    if (saved) {
                        {{.note-textarea}}.value = saved;
                        if (savedTime) {
                            {{.last-saved}}.textContent = 'æœ€åä¿å­˜: ' + savedTime;
                        }
                        console.log('ğŸŒ¸ ç‚æœµè‰çš„æš–è‰²ç¬”è®°å·²åŠ è½½');
                    }
                },
                
                Clear: function() {
                    if (confirm('ç¡®å®šè¦æ¸…ç©ºç‚æœµè‰çš„æš–è‰²ç¬”è®°å—ï¼Ÿè¿™äº›ç¾å¥½çš„å›å¿†å°†ä¼šæ¶ˆå¤±...')) {
                        {{.note-textarea}}.value = '';
                        localStorage.removeItem('chtholly_warm_note');
                        localStorage.removeItem('chtholly_warm_note_time');
                        {{.save-status}}.textContent = 'å·²æ¸…ç©º';
                        {{.last-saved}}.textContent = '';
                        console.log('ğŸŒ¸ ç‚æœµè‰çš„æš–è‰²ç¬”è®°å·²æ¸…ç©º');
                    }
                },
                
                Export: function() {
                    const content = {{.note-textarea}}.value;
                    if (!content.trim()) {
                        alert('ç¬”è®°å†…å®¹ä¸ºç©ºï¼Œæ— æ³•å¯¼å‡º');
                        return;
                    }
                    
                    const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'ç‚æœµè‰çš„æš–è‰²ç¬”è®°_' + new Date().toISOString().slice(0, 10) + '.txt';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    console.log('ğŸŒ¸ ç‚æœµè‰çš„æš–è‰²ç¬”è®°å·²å¯¼å‡º');
                },
                
                updateStats: function() {
                    const content = {{.note-textarea}}.value;
                    const wordCount = content.trim().split(/\s+/).filter(word => word.length > 0).length;
                    const charCount = content.length;
                    const lineCount = content.split('\n').length;
                    
                    {{.word-count}}.textContent = wordCount;
                    {{.char-count}}.textContent = charCount;
                    {{.line-count}}.textContent = lineCount;
                },
                
                showSaveAnimation: function() {
                    {{.save-status}}.style.animation = 'saveGlow 1s ease-out';
                    setTimeout(() => {
                        {{.save-status}}.style.animation = '';
                    }, 1000);
                }
            });
            
            // è‡ªåŠ¨ä¿å­˜åŠŸèƒ½
            let autoSaveTimer;
            {{.note-textarea}}->listen({
                input: function() {
                    warmNoteController->updateStats();
                    {{.save-status}}.textContent = 'æœªä¿å­˜';
                    
                    // é˜²æŠ–è‡ªåŠ¨ä¿å­˜
                    clearTimeout(autoSaveTimer);
                    autoSaveTimer = setTimeout(() => {
                        warmNoteController->Save();
                    }, 2000);
                }
            });
            
            // å·¥å…·æ æŒ‰é’®äº‹ä»¶
            {{.save-btn}}->listen({
                click: function() {
                    warmNoteController->Save();
                }
            });
            
            {{.load-btn}}->listen({
                click: function() {
                    warmNoteController->Load();
                }
            });
            
            {{.clear-btn}}->listen({
                click: function() {
                    warmNoteController->Clear();
                }
            });
            
            {{.export-btn}}->listen({
                click: function() {
                    warmNoteController->Export();
                }
            });
            
            // å¿«æ·é”®æ”¯æŒ
            {{.note-textarea}}->listen({
                keydown: function(event) {
                    if (event.ctrlKey || event.metaKey) {
                        if (event.key === 's') {
                            event.preventDefault();
                            warmNoteController->Save();
                        } else if (event.key === 'o') {
                            event.preventDefault();
                            warmNoteController->Load();
                        }
                    }
                }
            });
            
            // åˆå§‹åŒ–
            {{document}}->listen({
                DOMContentLoaded: function() {
                    warmNoteController->Load();
                    warmNoteController->updateStats();
                    {{.note-textarea}}.focus();
                    
                    console.log('ğŸŒ¸ ç‚æœµè‰çš„æš–è‰²ç¬”è®°å·²å‡†å¤‡å°±ç»ªï¼Œè®°å½•ç¾å¥½çš„å›å¿†å§...');
                }
            });
        }
        
        div
        {
            class: "note-header";
            
            h2
            {
                class: "note-title";
                text { "ç‚æœµè‰çš„æš–è‰²ç¬”è®°" }
            }
            
            p
            {
                class: "note-subtitle";
                text { "è®°å½•æœ€çè´µçš„æ—¶å…‰ï¼Œæ¸©æš–å¦‚é˜³å…‰èˆ¬çš„å›å¿†" }
            }
        }
        
        div
        {
            class: "note-toolbar";
            
            div
            {
                class: "toolbar-group";
                
                button
                {
                    class: "toolbar-btn save-btn";
                    text { "ä¿å­˜" }
                }
                
                button
                {
                    class: "toolbar-btn load-btn";
                    text { "åŠ è½½" }
                }
                
                button
                {
                    class: "toolbar-btn export-btn";
                    text { "å¯¼å‡º" }
                }
                
                button
                {
                    class: "toolbar-btn clear-btn";
                    text { "æ¸…ç©º" }
                }
            }
            
            div
            {
                class: "note-stats";
                
                div
                {
                    class: "stat-item";
                    text { "å­—æ•°: " }
                    span
                    {
                        class: "word-count";
                        text { "0" }
                    }
                }
                
                div
                {
                    class: "stat-item";
                    text { "å­—ç¬¦: " }
                    span
                    {
                        class: "char-count";
                        text { "0" }
                    }
                }
                
                div
                {
                    class: "stat-item";
                    text { "è¡Œæ•°: " }
                    span
                    {
                        class: "line-count";
                        text { "1" }
                    }
                }
            }
        }
        
        div
        {
            class: "note-editor";
            
            textarea
            {
                class: "note-textarea";
                placeholder: "åœ¨è¿™é‡Œè®°å½•ç‚æœµè‰æœ€ç¾å¥½çš„å›å¿†...

å°±åƒé‚£ä¸ªæ˜¥å¤©çš„åˆåï¼Œé˜³å…‰é€è¿‡æ¨±èŠ±æ ‘æ´’åœ¨å¥¹çš„è„¸ä¸Šï¼Œ
å¥¹ç¬‘å¾—é‚£ä¹ˆç¿çƒ‚ï¼Œé‚£ä¹ˆçº¯çœŸ...

è¿™äº›æ¸©æš–çš„æ—¶å…‰ï¼Œå€¼å¾—è¢«æ°¸è¿œçè—ã€‚";
            }
        }
        
        div
        {
            class: "note-footer";
            
            div
            {
                class: "save-status";
                text { "å‡†å¤‡å°±ç»ª" }
            }
            
            div
            {
                class: "last-saved";
                text { "" }
            }
        }
    }
}

// æŒ‰CHTLè¯­æ³•æ–‡æ¡£ï¼šå®šä¹‰ç›¸å…³çš„è‡ªå®šä¹‰æ ·å¼ç»„å’Œå˜é‡ç»„
[Custom] @Style ChthollyWarmNoteStyle
{
    warm-background,
    warm-border,
    warm-text-color;
    
    border-radius: 20px;
    font-family: "Georgia", serif;
    box-shadow: 0 10px 30px rgba(255, 218, 185, 0.3);
    transition: all 0.3s ease;
}

[Custom] @Var ChthollyWarmTheme
{
    warmBackground: "linear-gradient(135deg, #fff8dc 0%, #ffefd5 50%, #ffe4e1 100%)";
    warmBorder: "#ffd4a3";
    warmText: "#d2691e";
    warmAccent: "#cd853f";
    warmGlow: "rgba(255, 218, 185, 0.3)";
}