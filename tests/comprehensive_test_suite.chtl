// ============================================
// CHTL ç»¼åˆè¯­æ³•ç‰¹æ€§æµ‹è¯•å¥—ä»¶
// æµ‹è¯•æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å’Œè¯­æ³•ç‰¹æ€§
// ============================================

[Configuration]
enableSelectorAutomation = true
enableContextualComments = true
enableOriginNodes = true
enableSPA = true

[Namespace] TestSuite {

    // ============ 1. åŸºç¡€HTMLç»“æ„æµ‹è¯• ============
    html {
        head {
            title { "CHTLç»¼åˆæµ‹è¯•å¥—ä»¶" }
            
            // å…¨å±€æ ·å¼æµ‹è¯•
            style {
                body {
                    font-family: Arial, sans-serif;
                    margin: 0;
                    padding: 20px;
                    background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
                }
                
                .test-section {
                    margin: 20px 0;
                    padding: 15px;
                    border: 2px solid #333;
                    border-radius: 8px;
                    background-color: rgba(255, 255, 255, 0.9);
                }
                
                .highlight {
                    color: rgb(255, 0, 0);
                    font-weight: bold;
                    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
                }
                
                .dynamic-width {
                    width: calc(100% - 40px);
                    max-width: 800px;
                    min-height: 50vh;
                }
            }
        }
        
        body {
            // ============ 2. åŸºç¡€å…ƒç´ å’Œæ–‡æœ¬æµ‹è¯• ============
            div.test-section {
                h1.highlight { "åŸºç¡€å…ƒç´ æµ‹è¯•" }
                
                p { "è¿™æ˜¯ä¸€ä¸ªæ®µè½ï¼Œæµ‹è¯•åŸºæœ¬çš„æ–‡æœ¬å†…å®¹å¤„ç†ã€‚" }
                
                div {
                    span.highlight { "åµŒå¥—å…ƒç´ " }
                    text { " - æµ‹è¯•å…ƒç´ åµŒå¥—å’Œæ–‡æœ¬æ··åˆã€‚" }
                }
                
                // å±€éƒ¨æ ·å¼æµ‹è¯•
                style {
                    background-color: #fff3cd;
                    border-left: 4px solid #ffc107;
                    padding-left: 15px;
                }
            }
            
            // ============ 3. CSSå±æ€§å€¼å®Œæ•´æ€§æµ‹è¯• ============
            div.test-section.dynamic-width {
                h2 { "CSSå±æ€§å€¼æµ‹è¯•" }
                
                div {
                    text { "æµ‹è¯•å„ç§CSSå±æ€§å€¼ç±»å‹" }
                    
                    style {
                        // é¢œè‰²å€¼æµ‹è¯•
                        color: #ff6b6b;
                        background-color: rgba(107, 203, 119, 0.3);
                        border-color: hsl(200, 50%, 60%);
                        
                        // å°ºå¯¸å’Œå•ä½æµ‹è¯•
                        width: 75%;
                        height: 120px;
                        margin: 10px 15px 20px 25px;
                        padding: 1em 2rem 1.5vh 3vw;
                        
                        // CSSå‡½æ•°æµ‹è¯•
                        transform: rotate(5deg) scale(1.1);
                        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
                        background-image: url('test-image.jpg');
                        font-size: clamp(14px, 2vw, 18px);
                        
                        // å¤æ‚è®¡ç®—
                        width: calc(100% - 2 * 20px);
                        height: min(300px, 50vh);
                        
                        // é‡è¦æ€§å£°æ˜
                        position: relative !important;
                        z-index: 999 !important;
                    }
                }
            }
            
            // ============ 4. CHTL JSå’Œè™šå¯¹è±¡æµ‹è¯• ============
            div.test-section {
                h2 { "CHTL JS å’Œè™šå¯¹è±¡æµ‹è¯•" }
                
                script {
                    // è™šå¯¹è±¡å®šä¹‰æµ‹è¯•
                    vir Calculator = function(operation, a, b) {
                        switch(operation) {
                            case 'add': return a + b;
                            case 'multiply': return a * b;
                            case 'divide': return b !== 0 ? a / b : 'Error: Division by zero';
                            default: return 'Unknown operation';
                        }
                    };
                    
                    vir Logger = function(level, message) {
                        const timestamp = new Date().toISOString();
                        console.log(`[${timestamp}] ${level.toUpperCase()}: ${message}`);
                    };
                    
                    // æµ‹è¯•è™šå¯¹è±¡è°ƒç”¨
                    const result1 = Calculator->add(10, 5);
                    const result2 = Calculator->multiply(3, 7);
                    Logger->info(`è®¡ç®—ç»“æœ: ${result1}, ${result2}`);
                }
                
                div {
                    text { "è™šå¯¹è±¡æµ‹è¯•å®Œæˆï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºã€‚" }
                    
                    style {
                        background-color: #d4edda;
                        border: 1px solid #c3e6cb;
                        color: #155724;
                        padding: 10px;
                        border-radius: 4px;
                    }
                }
            }
            
            // ============ 5. [Origin] åŸå§‹åµŒå…¥èŠ‚ç‚¹æµ‹è¯• ============
            div.test-section {
                h2 { "åŸå§‹åµŒå…¥èŠ‚ç‚¹æµ‹è¯•" }
                
                p { "ä»¥ä¸‹æ˜¯åŸå§‹HTMLä»£ç åµŒå…¥ï¼š" }
                
                [Origin] @Html {
                    <div class="raw-html-content">
                        <strong>è¿™æ˜¯åŸå§‹HTMLå†…å®¹</strong>
                        <ul>
                            <li>åˆ—è¡¨é¡¹ 1</li>
                            <li>åˆ—è¡¨é¡¹ 2</li>
                        </ul>
                    </div>
                }
                
                [Origin] @Style {
                    .raw-html-content {
                        background: #e7f3ff;
                        padding: 15px;
                        border-radius: 6px;
                        margin: 10px 0;
                    }
                    
                    .raw-html-content strong {
                        color: #0066cc;
                    }
                }
                
                [Origin] @JavaScript {
                    document.addEventListener('DOMContentLoaded', function() {
                        console.log('åŸå§‹JavaScriptä»£ç æ‰§è¡ŒæˆåŠŸï¼');
                        const rawContent = document.querySelector('.raw-html-content');
                        if (rawContent) {
                            rawContent.addEventListener('click', function() {
                                alert('åŸå§‹HTMLå†…å®¹è¢«ç‚¹å‡»ï¼');
                            });
                        }
                    });
                }
            }
            
            // ============ 6. ä¸Šä¸‹æ–‡æ³¨é‡Šæµ‹è¯• ============
            div.test-section {
                h2 { "ä¸Šä¸‹æ–‡æ³¨é‡Šæµ‹è¯•" }
                
                "-- è¿™æ˜¯CHTLä¸Šä¸‹æ–‡ä¸­çš„æ³¨é‡Šï¼Œåº”è¯¥è½¬æ¢ä¸ºHTMLæ³¨é‡Š"
                
                script {
                    "-- è¿™æ˜¯JavaScriptä¸Šä¸‹æ–‡ä¸­çš„æ³¨é‡Šï¼Œåº”è¯¥è½¬æ¢ä¸ºJSæ³¨é‡Š"
                    var testVar = "æ³¨é‡Šæµ‹è¯•";
                }
                
                style {
                    "-- è¿™æ˜¯CSSä¸Šä¸‹æ–‡ä¸­çš„æ³¨é‡Šï¼Œåº”è¯¥è½¬æ¢ä¸ºCSSæ³¨é‡Š"
                    .comment-test {
                        color: blue;
                    }
                }
            }
            
            // ============ 7. æ¨¡æ¿å’Œå¼•ç”¨æµ‹è¯• ============
            div.test-section {
                h2 { "æ¨¡æ¿å¼•ç”¨æµ‹è¯•" }
                
                [Template] ButtonTemplate {
                    button {
                        @text
                        style {
                            background-color: @bgColor;
                            color: @textColor;
                            border: none;
                            padding: 10px 20px;
                            border-radius: 4px;
                            cursor: pointer;
                        }
                    }
                }
                
                // ä½¿ç”¨æ¨¡æ¿
                @ButtonTemplate {
                    text: "ç‚¹å‡»æˆ‘";
                    bgColor: "#007bff";
                    textColor: "white";
                }
                
                @ButtonTemplate {
                    text: "å–æ¶ˆ";
                    bgColor: "#6c757d";
                    textColor: "white";
                }
            }
            
            // ============ 8. å¤æ‚åµŒå¥—å’Œæ··åˆè¯­æ³•æµ‹è¯• ============
            div.test-section {
                h2 { "å¤æ‚åµŒå¥—å’Œæ··åˆè¯­æ³•æµ‹è¯•" }
                
                div {
                    style {
                        display: flex;
                        flex-direction: column;
                        gap: 15px;
                    }
                    
                    div {
                        h3 { "åµŒå¥—æµ‹è¯• Level 1" }
                        
                        div {
                            h4 { "åµŒå¥—æµ‹è¯• Level 2" }
                            
                            script {
                                // åµŒå¥—è„šæœ¬ä¸­çš„CHTL JS
                                vir NestedFunction = function(depth) {
                                    return `å½“å‰åµŒå¥—æ·±åº¦: ${depth}`;
                                };
                                
                                console.log(NestedFunction->call(2));
                            }
                            
                            div {
                                text { "åµŒå¥—æµ‹è¯• Level 3" }
                                
                                style {
                                    background: linear-gradient(
                                        135deg,
                                        rgba(255, 0, 150, 0.3) 0%,
                                        rgba(0, 204, 255, 0.3) 100%
                                    );
                                    padding: 20px;
                                    border-radius: 10px;
                                    box-shadow: 
                                        inset 0 1px 3px rgba(0, 0, 0, 0.1),
                                        0 2px 6px rgba(0, 0, 0, 0.2);
                                }
                            }
                        }
                    }
                }
            }
            
            // ============ 9. æ€§èƒ½å’Œè¾¹ç•Œæµ‹è¯• ============
            div.test-section {
                h2 { "æ€§èƒ½å’Œè¾¹ç•Œæµ‹è¯•" }
                
                // å¤§é‡é‡å¤å…ƒç´ æµ‹è¯•
                div {
                    style {
                        display: grid;
                        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
                        gap: 10px;
                    }
                    
                    // ç”Ÿæˆå¤šä¸ªæµ‹è¯•å…ƒç´ 
                    div { text { "å…ƒç´  1" } style { background: #ff9999; padding: 10px; } }
                    div { text { "å…ƒç´  2" } style { background: #99ff99; padding: 10px; } }
                    div { text { "å…ƒç´  3" } style { background: #9999ff; padding: 10px; } }
                    div { text { "å…ƒç´  4" } style { background: #ffff99; padding: 10px; } }
                    div { text { "å…ƒç´  5" } style { background: #ff99ff; padding: 10px; } }
                    div { text { "å…ƒç´  6" } style { background: #99ffff; padding: 10px; } }
                }
            }
            
            // ============ 10. æµ‹è¯•ç»“æœæ€»ç»“ ============
            div.test-section {
                h2 { "æµ‹è¯•å®Œæˆ" }
                
                div {
                    style {
                        background: linear-gradient(45deg, #28a745, #20c997);
                        color: white;
                        padding: 20px;
                        border-radius: 8px;
                        text-align: center;
                        font-size: 18px;
                        font-weight: bold;
                    }
                    
                    text { "ğŸ‰ CHTLç»¼åˆæµ‹è¯•å¥—ä»¶æ‰§è¡Œå®Œæˆï¼" }
                }
                
                script {
                    // æµ‹è¯•å®Œæˆåçš„ç»Ÿè®¡
                    vir TestReporter = function() {
                        const sections = document.querySelectorAll('.test-section').length;
                        const elements = document.querySelectorAll('*').length;
                        
                        console.log('=== CHTLæµ‹è¯•ç»Ÿè®¡ ===');
                        console.log(`æµ‹è¯•ç« èŠ‚æ•°: ${sections}`);
                        console.log(`æ€»å…ƒç´ æ•°: ${elements}`);
                        console.log('æ‰€æœ‰æµ‹è¯•æ‰§è¡Œå®Œæˆï¼');
                        
                        return {
                            sections: sections,
                            elements: elements,
                            status: 'completed'
                        };
                    };
                    
                    // æ‰§è¡Œæµ‹è¯•æŠ¥å‘Š
                    const report = TestReporter->call();
                    console.log('æµ‹è¯•æŠ¥å‘Š:', report);
                }
            }
        }
    }
}